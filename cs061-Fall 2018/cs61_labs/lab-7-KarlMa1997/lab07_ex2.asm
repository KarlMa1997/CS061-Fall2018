;=================================================
; Name: Kaihang Ma
; Email:  kma023
; GitHub username: KarlMa1997
; 
; Lab: lab 7
; Lab section: 028
; TA: Jason
; 
;=================================================
;MAIN CODE
.ORIG x3000
LD R1,SUB_1_x3500
JSRR  R1
LD R2,SUB_2_x4000
JSRR R2

HALT

;DATA x3000
SUB_1_x3500  .FILL  x3500
SUB_2_x4000  .FILL  x4000
;=================================================
;=================================================
;SUBROUTINE: SUB_1_x3500
;PARAMETER: R1
;POSTCONDITION; INIT
;RETURN R6
.ORIG x3500
ST R0,BACKUP_R0_x3500
ST R1,BACKUP_R1_x3500
ST R2,BACKUP_R2_x3500
ST R3,BACKUP_R3_x3500
ST R4,BACKUP_R4_x3500
ST R5,BACKUP_R5_x3500
;ST R6,BACKUP_R6_x3500
ST R7,BACKUP_R7_x3500

LD  R0,PROMPTR
PUTS

GETC
OUT

AND R6,R6,#0
ADD R6,R0,#0


LD R0,BACKUP_R0_x3500
LD R1,BACKUP_R1_x3500
LD R2,BACKUP_R2_x3500
LD R3,BACKUP_R3_x3500
LD R4,BACKUP_R4_x3500
LD R5,BACKUP_R5_x3500
;LD R6,BACKUP_R6_x3500
LD R7,BACKUP_R7_x3500

RET
;DATA x3500
BACKUP_R0_x3500 .BLKW #1
BACKUP_R1_x3500 .BLKW #1
BACKUP_R2_x3500 .BLKW #1
BACKUP_R3_x3500 .BLKW #1
BACKUP_R4_x3500 .BLKW #1
BACKUP_R5_x3500 .BLKW #1
;BACKUP_R6_x3500 .BLKW #1
BACKUP_R7_x3500 .BLKW #1
PROMPTR .FILL x6000
.ORIG x6000
PROM .STRINGZ "INPUT A SINGLE CHARACTER AT THE KEYBOARD \n"
;================================================
;=================================================
;SUBROUTINE: SUB_2_x4000
;PARAMETER: R2
;POSTCONDITION; PASS R6 INTO
;RETURN NONE
.ORIG x4000
ST R0,BACKUP_R0_x4000
ST R1,BACKUP_R1_x4000
ST R2,BACKUP_R2_x4000
ST R3,BACKUP_R3_x4000
ST R4,BACKUP_R4_x4000
ST R5,BACKUP_R5_x4000
;ST R6,BACKUP_R6_x4000
ST R7,BACKUP_R7_x4000

LD R0,OUT1ptr
PUTS

AND R0,R0,#0
ADD R0,R6,#0
OUT

AND R0,R0,#0
AND R1,R1,#0 
AND R3,R3,#0
ADD R1,R6,#0

LOOP
  ADD R6,R6,R6
  BRp LOOP
  BRn COUNT1
  BRz #3

COUNT1
  ADD R3,R3,#1
  BR LOOP

AND R0,R0,#0
LD R0,ISptr
PUTS

AND R0,R0,#0
LD R0,HEX30
ADD R3,R3,R0
ADD R0,R3,#0
OUT

LD R0,BACKUP_R0_x4000
LD R1,BACKUP_R1_x4000
LD R2,BACKUP_R2_x4000
LD R3,BACKUP_R3_x4000
LD R4,BACKUP_R4_x4000
LD R5,BACKUP_R5_x4000
;LD R6,BACKUP_R6_x4000
LD R7,BACKUP_R7_x4000

RET
;DATA x4000
BACKUP_R0_x4000 .BLKW #1
BACKUP_R1_x4000 .BLKW #1
BACKUP_R2_x4000 .BLKW #1
BACKUP_R3_x4000 .BLKW #1
BACKUP_R4_x4000 .BLKW #1
BACKUP_R5_x4000 .BLKW #1
;BACKUP_R6_x4000 .BLKW #1
BACKUP_R7_x4000 .BLKW #1
HEX30 .FILL x0030
OUT1ptr .FILL x6100
ISptr .FILL x6200
.ORIG x6100
OUT1 .STRINGZ "\nTHE NUMBER OF LEADING ONE IN "
.ORIG x6200
IS .STRINGZ " IS: "

